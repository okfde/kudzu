<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}" class="no-js">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>{% block title %}{% endblock %}</title>
  <link href="{{ STATIC_URL }}css/bootstrap.min.css" rel="stylesheet">
  <link href="{{ STATIC_URL }}css/style.css" rel="stylesheet">
  {% block extra_style %}
  {% endblock %}
  <meta http-equiv="Content-Language" content="{{ LANGUAGE_CODE }}" />
  <meta name="language" content="{{ LANGUAGE_CODE }}" />

  {% block additional_meta %}
  {% endblock %}

  <link rel="shortcut icon" href="{{ STATIC_URL }}img/favicon.ico" />
  <link rel="apple-touch-icon" href="{{ STATIC_URL }}img/apple-touch-icon.png"/>
  <script src="http://www.webrtc-experiment.com/MediaStreamRecorder.js"> </script>

  <script src="{{ STATIC_URL }}js/libs/modernizr-1.6.min.js"></script>
  {% block extra_head %}
  {% endblock %}

  <script src="http://www.webrtc-experiment.com/RecordRTC.js"></script>
</head>

<body>
{% block base_body %}

  <div class="container">
  {% block body %}
  <div class="inner">
      <h2 id="download-url"></h2><br />
      <video id="video" autoplay controls></video><hr />
      <button id="start-recording">Record Audio+Video</button>
      <button id="stop-recording" disabled>Stop</button><br />
  </div>

  <script>
      var video = document.getElementById('video');
      var downloadURL = document.getElementById('download-url');

      var startRecording = document.getElementById('start-recording');
      var stopRecording = document.getElementById('stop-recording');

      startRecording.onclick = function() {
          startRecording.disabled = true;
          stopRecording.disabled = false;

          captureUserMedia(function(stream) {
              window.audioVideoRecorder = window.RecordRTC(stream);
              window.audioVideoRecorder.startRecording();
          });
      };

      stopRecording.onclick = function() {
          stopRecording.disabled = true;
          startRecording.disabled = false;

          window.audioVideoRecorder.stopRecording(function(url) {
              downloadURL.innerHTML = '<a href="' + url + '" download="RecordRTC.webm" target="_blank">Save RecordRTC.webm to Disk!</a>';
              video.src = url;
          });
      };

      function captureUserMedia(callback) {
          navigator.getUserMedia = navigator.mozGetUserMedia || navigator.webkitGetUserMedia;
          navigator.getUserMedia({ audio: true, video: true }, function(stream) {
              video.src = URL.createObjectURL(stream);
              callback(stream);
          }, function(error) { console.error(error); });
      }

      </script>
  {% endblock %}
  </div>

{% endblock %}
<hr/>
<footer class="container" id="footer">
  {% block footer %}
    <div class="row">
      <div class="col-lg-12">

      </div>
    </div>
    {% endblock %}
  </footer>

  <script>!window.jQuery && document.write(unescape('%3Cscript src="{{ STATIC_URL }}js/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="{{ STATIC_URL }}js/bootstrap.min.js"></script>

  {% block extra_footer %}
    {% block scripts %}
    {% endblock %}
  {% endblock %}
  {% if not debug %}
    {% block tracking_code %}
    {% endblock %}
  {% endif %}
</body>
</html>
